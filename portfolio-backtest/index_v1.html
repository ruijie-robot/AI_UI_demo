<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»„åˆæ¨¡æ‹Ÿå›æµ‹ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f0f2f5;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* ä¸»å†…å®¹åŒºåŸŸï¼ˆå·¦ä¾§ï¼‰ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 20px;
            overflow: hidden;
        }

        /* çª—å£2ï¼šæŠ˜çº¿å›¾ */
        .chart-window {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .window-header {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .window-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #f8fafc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chart-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            cursor: crosshair;
            border-radius: 8px;
        }

        .chart-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .click-marker {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #ef4444;
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.8; }
        }

        .chart-hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 0.9em;
            pointer-events: none;
        }

        /* çª—å£3ï¼šæ–°é—»åˆ—è¡¨ */
        .news-window {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .news-list {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .news-list::-webkit-scrollbar {
            width: 6px;
        }

        .news-list::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }

        .news-list::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .news-list::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .news-item {
            background: #f8fafc;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-left: 4px solid #667eea;
            transition: all 0.3s;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .news-item:hover {
            background: #f1f5f9;
            transform: translateX(5px);
        }

        .news-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .news-title {
            font-weight: 600;
            color: #1e293b;
            font-size: 1.05em;
            flex: 1;
            margin-right: 10px;
        }

        .news-date {
            color: #94a3b8;
            font-size: 0.85em;
            white-space: nowrap;
        }

        .news-content {
            color: #475569;
            line-height: 1.7;
            font-size: 0.95em;
            margin-bottom: 10px;
        }

        .news-source {
            color: #94a3b8;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .news-tag {
            display: inline-block;
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            margin-right: 8px;
        }

        .empty-news {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #94a3b8;
            text-align: center;
        }

        .empty-news-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        /* çª—å£1ï¼šChatä¾§è¾¹æ ï¼ˆå³ä¾§ï¼‰ */
        .chat-sidebar {
            width: 420px;
            background: white;
            box-shadow: -2px 0 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        .chat-header {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .chat-header h2 {
            font-size: 1.4em;
            margin-bottom: 5px;
        }

        .chat-header p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8fafc;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .message {
            margin-bottom: 16px;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            display: flex;
            justify-content: flex-end;
        }

        .message.assistant {
            display: flex;
            justify-content: flex-start;
        }

        .message-bubble {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 12px;
            line-height: 1.6;
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-bubble {
            background: white;
            color: #334155;
            border: 1px solid #e2e8f0;
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 0.75em;
            opacity: 0.7;
            margin-top: 4px;
        }

        .quick-examples {
            padding: 15px 20px;
            background: #fffbeb;
            border-top: 1px solid #fef3c7;
        }

        .quick-examples-title {
            font-size: 0.85em;
            color: #92400e;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .example-chip {
            background: white;
            border: 1px solid #fbbf24;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85em;
            color: #78350f;
            text-align: left;
            margin-bottom: 8px;
        }

        .example-chip:hover {
            background: #fef3c7;
            transform: translateX(5px);
        }

        .chat-input-area {
            padding: 20px;
            border-top: 2px solid #e2e8f0;
            background: white;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            resize: none;
            font-family: inherit;
            min-height: 80px;
            max-height: 150px;
        }

        .chat-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .send-btn {
            padding: 0 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .send-btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
        }

        .loading-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .loading-indicator.show {
            display: flex;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #e2e8f0;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 1200px) {
            .chat-sidebar {
                width: 350px;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .chat-sidebar {
                width: 100%;
                height: 50vh;
            }

            .main-content {
                height: 50vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ä¸»å†…å®¹åŒºåŸŸï¼ˆå·¦ä¾§ï¼‰ -->
        <div class="main-content">
            <!-- çª—å£2ï¼šæŠ˜çº¿å›¾ -->
            <div class="chart-window">
                <div class="window-header">
                    <div class="window-title">ğŸ“ˆ å›æµ‹æŠ˜çº¿å›¾</div>
                </div>
                <div class="chart-container" id="chartContainer">
                    <img src="æŠ˜çº¿å›¾.jpg" alt="å›æµ‹æŠ˜çº¿å›¾" class="chart-image" id="chartImage" onclick="handleChartClick(event)">
                    <div class="chart-overlay" id="chartOverlay"></div>
                    <div class="chart-hint">ğŸ’¡ ç‚¹å‡»å›¾è¡¨æŸ¥çœ‹å¯¹åº”æ—¶é—´çš„è´¢æ”¿æ”¿ç­–æ–°é—»</div>
                </div>
            </div>

            <!-- çª—å£3ï¼šæ–°é—»åˆ—è¡¨ -->
            <div class="news-window">
                <div class="window-header">
                    <div class="window-title">ğŸ“° è´¢æ”¿æ‰©å¼ ç›¸å…³æ–°é—»</div>
                </div>
                <div class="news-list" id="newsList">
                    <div class="empty-news">
                        <div class="empty-news-icon">ğŸ“°</div>
                        <h3>ç‚¹å‡»å›¾è¡¨æŸ¥çœ‹æ–°é—»</h3>
                        <p>ç‚¹å‡»ä¸Šæ–¹æŠ˜çº¿å›¾çš„ä»»æ„ä½ç½®<br>æŸ¥çœ‹å¯¹åº”æ—¶é—´çš„è´¢æ”¿æ‰©å¼ æ”¿ç­–æ–°é—»</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- çª—å£1ï¼šChatä¾§è¾¹æ ï¼ˆå³ä¾§ï¼‰ -->
        <div class="chat-sidebar">
            <div class="chat-header">
                <h2>ğŸ’¬ ç­–ç•¥å¯¹è¯</h2>
                <p>æè¿°æ‚¨çš„æŠ•èµ„ç­–ç•¥éœ€æ±‚</p>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message assistant">
                    <div class="message-bubble">
                        <div>æ‚¨å¥½ï¼æˆ‘æ˜¯æ™ºèƒ½å›æµ‹åŠ©æ‰‹ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨çš„æŠ•èµ„ç­–ç•¥è¦æ±‚ï¼Œæˆ‘å°†ä¸ºæ‚¨è¿›è¡Œæ¨¡æ‹Ÿå›æµ‹åˆ†æã€‚</div>
                        <div class="message-time">åˆšåˆš</div>
                    </div>
                </div>
            </div>

            <div class="quick-examples">
                <div class="quick-examples-title">ğŸ’¡ å¿«é€Ÿç¤ºä¾‹</div>
                <div class="example-chip" onclick="useExample(this)">
                    60%ä»“ä½ç»™ä¸Šè¯æŒ‡æ•°ï¼Œ40%ä»“ä½ç”¨äºï¼Œå½“è´¢æ”¿æ”¿ç­–æ‰©å¼ æ—¶ï¼Œåšå¤šä¸å…¶ç›¸å…³çš„è‚¡ç¥¨ï¼Œæ¯åªè‚¡ç¥¨æŒä»“ç›¸åŒï¼Œæ€»æŒä»“40%
                </div>
            </div>

            <div class="chat-input-area">
                <div class="loading-indicator" id="loadingIndicator">
                    <div class="spinner"></div>
                    <span>AIæ­£åœ¨æ€è€ƒ...</span>
                </div>
                <div class="input-wrapper">
                    <textarea class="chat-input" id="chatInput"
                              placeholder="æè¿°æ‚¨çš„æŠ•èµ„ç­–ç•¥...&#10;ï¼ˆæŒ‰Ctrl+Enterå‘é€ï¼‰"
                              rows="3"></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                        å‘é€
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è´¢æ”¿æ‰©å¼ æ–°é—»æ•°æ®åº“
        const newsDatabase = {
            '2020': [
                {
                    title: 'è´¢æ”¿éƒ¨ï¼š2020å¹´ä¸€å­£åº¦ç§¯æè´¢æ”¿æ”¿ç­–åŠ åŠ›ææ•ˆ',
                    content: 'è´¢æ”¿éƒ¨å‘å¸ƒæ•°æ®æ˜¾ç¤ºï¼Œä¸€å­£åº¦å…¨å›½ä¸€èˆ¬å…¬å…±é¢„ç®—æ”¯å‡º55284äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿7.8%ã€‚å…¶ä¸­ï¼ŒåŸºç¡€è®¾æ–½å»ºè®¾æŠ•èµ„å¤§å¹…å¢åŠ ï¼Œä¸­å¤®è´¢æ”¿åŠ å¤§å¯¹åœ°æ–¹è½¬ç§»æ”¯ä»˜åŠ›åº¦ï¼Œæ”¯æŒåœ°æ–¹ç¨³æŠ•èµ„ã€è¡¥çŸ­æ¿ã€‚',
                    source: 'è´¢æ”¿éƒ¨å®˜ç½‘',
                    date: '2020-04-15',
                    tag: 'è´¢æ”¿æ”¿ç­–'
                },
                {
                    title: 'æ–°åŸºå»ºæŠ•èµ„è§„æ¨¡è¶…3ä¸‡äº¿ï¼Œ5Gã€æ•°æ®ä¸­å¿ƒæˆé‡ç‚¹',
                    content: 'å›½å®¶å‘æ”¹å§”è¡¨ç¤ºï¼Œå°†åŠ å¿«æ¨è¿›æ–°å‹åŸºç¡€è®¾æ–½å»ºè®¾ï¼Œé¢„è®¡å…¨å¹´æŠ•èµ„è§„æ¨¡å°†è¶…è¿‡3ä¸‡äº¿å…ƒã€‚é‡ç‚¹æ”¯æŒ5Gç½‘ç»œã€æ•°æ®ä¸­å¿ƒã€å·¥ä¸šäº’è”ç½‘ç­‰é¢†åŸŸï¼Œæ¨åŠ¨ç»æµé«˜è´¨é‡å‘å±•ã€‚',
                    source: 'æ–°åç¤¾',
                    date: '2020-05-22',
                    tag: 'åŸºå»ºæŠ•èµ„'
                }
            ],
            '2021': [
                {
                    title: 'ä¸­å¤®ç»æµå·¥ä½œä¼šè®®ï¼šä¿æŒå®è§‚æ”¿ç­–è¿ç»­æ€§ç¨³å®šæ€§',
                    content: 'ä¼šè®®å¼ºè°ƒï¼Œç§¯æçš„è´¢æ”¿æ”¿ç­–è¦æè´¨å¢æ•ˆã€æ›´å¯æŒç»­ã€‚è¦ä¿æŒå¿…è¦çš„è´¢æ”¿æ”¯å‡ºå¼ºåº¦ï¼Œåœ¨ä¿ƒè¿›ç§‘æŠ€åˆ›æ–°ã€åŠ å¿«ç»æµç»“æ„è°ƒæ•´ã€è°ƒèŠ‚æ”¶å…¥åˆ†é…ä¸Šä¸»åŠ¨ä½œä¸ºï¼ŒæŠ“å®åŒ–è§£åœ°æ–¹æ”¿åºœéšæ€§å€ºåŠ¡é£é™©å·¥ä½œã€‚',
                    source: 'æ–°åç¤¾',
                    date: '2021-12-10',
                    tag: 'è´¢æ”¿æ”¿ç­–'
                },
                {
                    title: 'è´¢æ”¿æ”¯å‡ºç»“æ„ä¼˜åŒ–ï¼ŒåŸºå»ºæŠ•èµ„åŒæ¯”å¢15.6%',
                    content: '2021å¹´ä¸ŠåŠå¹´ï¼Œå…¨å›½åŸºç¡€è®¾æ–½å»ºè®¾æŠ•èµ„åŒæ¯”å¢é•¿15.6%ï¼Œå…¶ä¸­äº¤é€šè¿è¾“ã€æ°´åˆ©ç®¡ç†ç­‰é¢†åŸŸæŠ•èµ„å¢é€Ÿè¾ƒå¿«ã€‚è´¢æ”¿éƒ¨åŠ å¤§å¯¹é‡ç‚¹é¡¹ç›®å’Œé‡å¤§å·¥ç¨‹çš„æ”¯æŒåŠ›åº¦ã€‚',
                    source: 'Windèµ„è®¯',
                    date: '2021-07-18',
                    tag: 'åŸºå»ºæŠ•èµ„'
                }
            ],
            '2022': [
                {
                    title: 'æ”¿åºœå·¥ä½œæŠ¥å‘Šï¼š2022å¹´èµ¤å­—ç‡æ‹ŸæŒ‰2.8%å·¦å³å®‰æ’',
                    content: 'æ”¿åºœå·¥ä½œæŠ¥å‘ŠæŒ‡å‡ºï¼Œä»Šå¹´èµ¤å­—ç‡æ‹ŸæŒ‰2.8%å·¦å³å®‰æ’ï¼Œä¸­å¤®å¯¹åœ°æ–¹è½¬ç§»æ”¯ä»˜å¢åŠ çº¦1.5ä¸‡äº¿å…ƒã€è§„æ¨¡è¿‘9.8ä¸‡äº¿å…ƒã€‚é€‚åº¦è¶…å‰å¼€å±•åŸºç¡€è®¾æ–½æŠ•èµ„ï¼Œå»ºè®¾é‡ç‚¹æ°´åˆ©å·¥ç¨‹ã€‚',
                    source: 'ä¸­å›½æ”¿åºœç½‘',
                    date: '2022-03-05',
                    tag: 'è´¢æ”¿é¢„ç®—'
                },
                {
                    title: 'ä¸“é¡¹å€ºå‘è¡Œæé€Ÿï¼Œæ”¯æŒåŸºå»ºæŠ•èµ„ç¨³å¢é•¿',
                    content: 'å‰ä¸‰å­£åº¦æ–°å¢ä¸“é¡¹å€ºåˆ¸å‘è¡Œè§„æ¨¡è¾¾3.45ä¸‡äº¿å…ƒï¼Œé‡ç‚¹æŠ•å‘äº¤é€šåŸºç¡€è®¾æ–½ã€èƒ½æºã€å†œæ—æ°´åˆ©ç­‰ä¹å¤§é¢†åŸŸã€‚åœ°æ–¹æ”¿åºœå€ºåˆ¸å‘è¡ŒèŠ‚å¥åŠ å¿«ï¼Œä¸ºç¨³å¢é•¿æä¾›æœ‰åŠ›æ”¯æ’‘ã€‚',
                    source: 'è¯åˆ¸æ—¶æŠ¥',
                    date: '2022-09-28',
                    tag: 'ä¸“é¡¹å€º'
                }
            ],
            '2023': [
                {
                    title: 'è´¢æ”¿éƒ¨ï¼š2023å¹´ç»§ç»­å®æ–½ç§¯æçš„è´¢æ”¿æ”¿ç­–',
                    content: 'è´¢æ”¿éƒ¨éƒ¨é•¿åˆ˜æ˜†è¡¨ç¤ºï¼Œ2023å¹´å°†ä¿æŒå¿…è¦çš„è´¢æ”¿æ”¯å‡ºå¼ºåº¦ï¼Œåˆç†å®‰æ’åœ°æ–¹æ”¿åºœä¸“é¡¹å€ºåˆ¸è§„æ¨¡ï¼Œæ”¯æŒé‡å¤§é¡¹ç›®å»ºè®¾å’Œè®¾å¤‡æ›´æ–°æ”¹é€ ã€‚é¢„è®¡å…¨å¹´ä¸€èˆ¬å…¬å…±é¢„ç®—æ”¯å‡ºå°†å¢é•¿5.6%ã€‚',
                    source: 'è´¢æ”¿éƒ¨å®˜ç½‘',
                    date: '2023-01-28',
                    tag: 'è´¢æ”¿æ”¿ç­–'
                },
                {
                    title: 'ä¸ŠåŠå¹´åŸºå»ºæŠ•èµ„å¢é•¿15.3%ï¼Œè´¢æ”¿æ”¿ç­–æ•ˆæœæ˜¾ç°',
                    content: 'å›½å®¶ç»Ÿè®¡å±€æ•°æ®æ˜¾ç¤ºï¼Œä¸ŠåŠå¹´åŸºç¡€è®¾æ–½æŠ•èµ„åŒæ¯”å¢é•¿15.3%ï¼Œå…¶ä¸­æ°´åˆ©ç®¡ç†ä¸šæŠ•èµ„å¢é•¿13.5%ï¼Œäº¤é€šè¿è¾“ä¸šæŠ•èµ„å¢é•¿16.2%ã€‚ç§¯æè´¢æ”¿æ”¿ç­–æŒç»­å‘åŠ›ï¼Œæœ‰æ•ˆæ‹‰åŠ¨ç»æµå¢é•¿ã€‚',
                    source: 'å›½å®¶ç»Ÿè®¡å±€',
                    date: '2023-07-15',
                    tag: 'åŸºå»ºæŠ•èµ„'
                },
                {
                    title: 'å¢å‘1ä¸‡äº¿å…ƒå›½å€ºæ”¯æŒç¾åé‡å»ºå’ŒåŸºç¡€è®¾æ–½å»ºè®¾',
                    content: 'å›½åŠ¡é™¢å†³å®šåœ¨ä»Šå¹´å››å­£åº¦å¢å‘2023å¹´å›½å€º1ä¸‡äº¿å…ƒï¼Œä½œä¸ºç‰¹åˆ«å›½å€ºç®¡ç†ã€‚èµ„é‡‘å…¨éƒ¨é€šè¿‡è½¬ç§»æ”¯ä»˜æ–¹å¼å®‰æ’ç»™åœ°æ–¹ï¼Œé›†ä¸­åŠ›é‡æ”¯æŒç¾åæ¢å¤é‡å»ºå’Œå¼¥è¡¥é˜²ç¾å‡ç¾æ•‘ç¾çŸ­æ¿ã€‚',
                    source: 'æ–°åç¤¾',
                    date: '2023-10-24',
                    tag: 'å›½å€ºå‘è¡Œ'
                }
            ],
            '2024': [
                {
                    title: '2024å¹´è´¢æ”¿èµ¤å­—ç‡æé«˜è‡³3%ï¼ŒåŠ å¤§å®è§‚è°ƒæ§åŠ›åº¦',
                    content: '2024å¹´æ”¿åºœå·¥ä½œæŠ¥å‘Šæ˜ç¡®ï¼Œèµ¤å­—ç‡æ‹ŸæŒ‰3%å®‰æ’ï¼Œèµ¤å­—è§„æ¨¡4.06ä¸‡äº¿å…ƒï¼Œæ¯”ä¸Šå¹´å¢åŠ 1800äº¿å…ƒã€‚æ‹Ÿå®‰æ’åœ°æ–¹æ”¿åºœä¸“é¡¹å€ºåˆ¸3.9ä¸‡äº¿å…ƒï¼Œè¿ç»­ç¬¬äºŒå¹´ä¿æŒè¾ƒé«˜è§„æ¨¡ã€‚',
                    source: 'ä¸­å›½æ”¿åºœç½‘',
                    date: '2024-03-05',
                    tag: 'è´¢æ”¿é¢„ç®—'
                },
                {
                    title: '"ä¸¤æ–°"æ”¿ç­–æ¨åŠ¨ï¼Œè®¾å¤‡æ›´æ–°å’Œæ¶ˆè´¹å“ä»¥æ—§æ¢æ–°å…¨é¢å¯åŠ¨',
                    content: 'å›½åŠ¡é™¢å°å‘ã€Šæ¨åŠ¨å¤§è§„æ¨¡è®¾å¤‡æ›´æ–°å’Œæ¶ˆè´¹å“ä»¥æ—§æ¢æ–°è¡ŒåŠ¨æ–¹æ¡ˆã€‹ï¼Œä¸­å¤®è´¢æ”¿è®¾ç«‹ä¸“é¡¹èµ„é‡‘ï¼Œæ”¯æŒé‡ç‚¹è¡Œä¸šè®¾å¤‡æ›´æ–°æ”¹é€ ã€‚é¢„è®¡å°†å¸¦åŠ¨ç¤¾ä¼šæŠ•èµ„è¶…5ä¸‡äº¿å…ƒã€‚',
                    source: 'ç»æµæ—¥æŠ¥',
                    date: '2024-04-12',
                    tag: 'æ”¿ç­–æ”¯æŒ'
                },
                {
                    title: 'å‰ä¸‰å­£åº¦è´¢æ”¿æ”¯å‡ºå¢é•¿9.2%ï¼ŒåŸºå»ºæŠ•èµ„ä¿æŒè¾ƒå¿«å¢é•¿',
                    content: 'è´¢æ”¿éƒ¨æ•°æ®æ˜¾ç¤ºï¼Œå‰ä¸‰å­£åº¦å…¨å›½ä¸€èˆ¬å…¬å…±é¢„ç®—æ”¯å‡º211430äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿9.2%ã€‚åŸºç¡€è®¾æ–½å»ºè®¾é¢†åŸŸæ”¯å‡ºåŠ›åº¦åŠ å¤§ï¼Œäº¤é€šè¿è¾“ã€æ°´åˆ©ç­‰é‡ç‚¹é¡¹ç›®æ¨è¿›é¡ºåˆ©ã€‚',
                    source: 'è´¢æ”¿éƒ¨å®˜ç½‘',
                    date: '2024-10-18',
                    tag: 'è´¢æ”¿æ”¯å‡º'
                }
            ]
        };

        let conversationStep = 0;

        // å‘é€æ¶ˆæ¯
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addMessage('user', message);
            input.value = '';

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loadingIndicator').classList.add('show');
            document.getElementById('sendBtn').disabled = true;

            // æ¨¡æ‹ŸAIå›å¤
            setTimeout(() => {
                let reply = '';

                if (conversationStep === 0) {
                    // ç¬¬ä¸€æ¬¡å›å¤ï¼šè¯¢é—®æŒæœ‰æ—¶é—´
                    reply = 'åšå¤šä¹‹åï¼Œä»“ä½æŒæœ‰å¤šä¹…ä¹‹åå–å‡ºï¼Ÿ';
                    conversationStep = 1;
                } else if (conversationStep === 1) {
                    // ç¬¬äºŒæ¬¡å›å¤ï¼šç¡®è®¤ç­–ç•¥å¹¶æ˜¾ç¤ºç»“æœ
                    reply = `å¥½çš„ï¼Œæˆ‘å·²ç†è§£æ‚¨çš„ç­–ç•¥ï¼š

â€¢ åŸºç¡€é…ç½®ï¼š60%ä»“ä½æŠ•èµ„ä¸Šè¯æŒ‡æ•°
â€¢ æ¡ä»¶ç­–ç•¥ï¼š40%ä»“ä½åœ¨è´¢æ”¿æ”¿ç­–æ‰©å¼ æ—¶åšå¤šç›¸å…³è‚¡ç¥¨
â€¢ æŒæœ‰å‘¨æœŸï¼š${message}

å›æµ‹å·²å®Œæˆï¼å·¦ä¾§æŠ˜çº¿å›¾æ˜¾ç¤ºäº†ç­–ç•¥è¡¨ç°ä¸ä¸Šè¯500çš„å¯¹æ¯”ã€‚æ‚¨å¯ä»¥ç‚¹å‡»å›¾è¡¨ä¸Šçš„ä»»æ„ä½ç½®ï¼ŒæŸ¥çœ‹å¯¹åº”æ—¶é—´ç‚¹çš„è´¢æ”¿æ‰©å¼ æ”¿ç­–æ–°é—»ã€‚`;
                    conversationStep = 2;
                } else {
                    reply = 'æ„Ÿè°¢æ‚¨çš„æé—®ï¼å¦‚éœ€è°ƒæ•´ç­–ç•¥æˆ–é‡æ–°å›æµ‹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚';
                }

                addMessage('assistant', reply);

                document.getElementById('loadingIndicator').classList.remove('show');
                document.getElementById('sendBtn').disabled = false;
            }, 1500);
        }

        // æ·»åŠ æ¶ˆæ¯
        function addMessage(type, content) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;

            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ':' +
                          now.getMinutes().toString().padStart(2, '0');

            messageDiv.innerHTML = `
                <div class="message-bubble">
                    <div style="white-space: pre-wrap;">${content}</div>
                    <div class="message-time">${timeStr}</div>
                </div>
            `;

            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // ä½¿ç”¨ç¤ºä¾‹
        function useExample(element) {
            const text = element.textContent;
            document.getElementById('chatInput').value = text;
            sendMessage();
        }

        // å¤„ç†å›¾è¡¨ç‚¹å‡»
        function handleChartClick(event) {
            const img = event.target;
            const rect = img.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            // è®¡ç®—ç›¸å¯¹ä½ç½®ï¼ˆ0-1ï¼‰
            const relativeX = x / rect.width;

            // æ ¹æ®Xä½ç½®åˆ¤æ–­å¹´ä»½ï¼ˆç²—ç•¥ä¼°è®¡ï¼‰
            let year;
            if (relativeX < 0.2) year = '2020';
            else if (relativeX < 0.4) year = '2021';
            else if (relativeX < 0.6) year = '2022';
            else if (relativeX < 0.8) year = '2023';
            else year = '2024';

            // æ·»åŠ ç‚¹å‡»æ ‡è®°
            const overlay = document.getElementById('chartOverlay');
            overlay.innerHTML = `<div class="click-marker" style="left: ${x}px; top: ${y}px;"></div>`;

            // æ˜¾ç¤ºå¯¹åº”å¹´ä»½çš„æ–°é—»
            showNews(year);
        }

        // æ˜¾ç¤ºæ–°é—»
        function showNews(year) {
            const newsList = document.getElementById('newsList');
            const news = newsDatabase[year] || [];

            if (news.length === 0) {
                newsList.innerHTML = `
                    <div class="empty-news">
                        <div class="empty-news-icon">ğŸ“°</div>
                        <h3>æš‚æ— æ–°é—»</h3>
                        <p>è¯¥æ—¶é—´æ®µæš‚æ— è´¢æ”¿æ‰©å¼ ç›¸å…³æ–°é—»</p>
                    </div>
                `;
                return;
            }

            let html = '';
            news.forEach((item, index) => {
                html += `
                    <div class="news-item" style="animation-delay: ${index * 0.1}s">
                        <div class="news-header">
                            <div class="news-title">${item.title}</div>
                            <div class="news-date">${item.date}</div>
                        </div>
                        <div class="news-content">${item.content}</div>
                        <div class="news-source">
                            <span class="news-tag">${item.tag}</span>
                            <span>ğŸ“° ${item.source}</span>
                        </div>
                    </div>
                `;
            });

            newsList.innerHTML = html;
        }

        // æ”¯æŒCtrl+Enterå‘é€
        document.getElementById('chatInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>
